#!/bin/bash
#SBATCH --job-name=download_images
#SBATCH --time=12:00:00
#SBATCH --ntasks=1
#SBATCH --cpus-per-task=1
#SBATCH --mem=35GB
#SBATCH -p compute
#SBATCH --array=0-463%10

# Path to the Singularity container
SINGULARITY_CONTAINER="enviro.sif"

# Base directory to hold all subdirectories with DICOM files
BASE_DIR="dicom_files_new2"
mkdir -p $BASE_DIR

# Array of S3 URLs
S3_URLS=(
    s3://idc-open-data/58752ff6-1d48-4e3d-8f5f-607f6671c30f/*
    s3://idc-open-data/dd5026d9-efb7-433b-bf48-5def7bcc781a/*
    s3://idc-open-data/0bb856a4-0be6-4fd3-b7fb-72b31ccc879a/*
    s3://idc-open-data/288e75f0-7ade-4e73-9e33-5de157e88dec/*
    s3://idc-open-data/a00e0590-8dd8-4528-abdc-e4389dfc9ced/*
    s3://idc-open-data/c0229bb6-3790-4c4c-a89e-36cfb2a92950/*
    s3://idc-open-data/e0194053-ac28-4c63-bd65-27bf550ea4ba/*
    s3://idc-open-data/c5db8f3f-91ec-442d-8e69-eff8d8c0d729/*
    s3://idc-open-data/f36b50b6-5745-4ffa-98b1-ae2405657e51/*
    s3://idc-open-data/828d8f31-f672-4402-884c-cd88f600d854/*
    s3://idc-open-data/01036a47-abbd-4643-9f43-a8965a81d605/*
    s3://idc-open-data/21fedf14-4064-4c4e-a911-1853fc5a7b40/*
    s3://idc-open-data/4717c295-9958-4cb1-8c46-f748060bdb7d/*
    s3://idc-open-data/c6466cae-1a25-49c6-a074-0b0451c08f88/*
    s3://idc-open-data/f06194ed-c633-43a9-b0b7-134196d82be6/*
    s3://idc-open-data/6dc46fcd-aa7c-4758-8a46-6cfbf52d021c/*
    s3://idc-open-data/0a661f07-870d-46ea-adb5-69411d5b1ced/*
    s3://idc-open-data/8b0cf049-7899-49dd-b44e-e48f7c226acd/*
    s3://idc-open-data/e8cb7f78-0c1e-450e-8685-da16cc4c114c/*
    s3://idc-open-data/39fa75d7-cab7-4b8a-a37a-fb2bbce9818a/*
    s3://idc-open-data/f6bbaef1-00c2-4a28-b467-5ae84a2baa2e/*
    s3://idc-open-data/3cf5f6b2-7da3-4b72-a2e0-659161f3bcd8/*
    s3://idc-open-data/ccc854ad-7677-45b2-a293-53231b42e86e/*
    s3://idc-open-data/16604e42-13f3-4069-8e93-d4aa086a718a/*
    s3://idc-open-data/4945c0af-ce68-49e1-8529-eac119e9db5d/*
    s3://idc-open-data/ab26d8ab-3302-4f47-939a-d22a80e0a454/*
    s3://idc-open-data/073a3722-8b98-4118-b7e6-710f0a1bb170/*
    s3://idc-open-data/b862799f-633d-45c1-b050-3da0c26413c7/*
    s3://idc-open-data/9d1017b7-2fbb-4fd3-8729-00e99ba92850/*
    s3://idc-open-data/150930f9-9ddc-47d3-9760-6296e2a134c9/*
    s3://idc-open-data/5a047086-08e7-4065-8e17-29953ee6090c/*
    s3://idc-open-data/c4a99474-82d4-46d6-983c-6948a143ecba/*
    s3://idc-open-data/b4738a30-08b0-46fc-9786-fe87ca1abd61/*
    s3://idc-open-data/25fbed96-2937-4d19-bc80-5cde6bf55867/*
    s3://idc-open-data/3c1a30fa-f247-43aa-9941-4dc8c7dea3c8/*
    s3://idc-open-data/dfaa5c42-f4fa-4bed-8274-58b34d7bff64/*
    s3://idc-open-data/8acdee45-5282-41de-923a-3592a2d18e89/*
    s3://idc-open-data/36e7a542-9f03-44d2-ac77-60a4ab4cb23a/*
    s3://idc-open-data/91789f95-6722-4323-b252-748bc01db2ed/*
    s3://idc-open-data/0ea4647d-7aba-4c46-9f39-cce79b21cc97/*
    s3://idc-open-data/bc430375-2b2c-40bd-a5c0-bea693ecc9b4/*
    s3://idc-open-data/83f2538a-a499-4809-91f1-80be725b2608/*
    s3://idc-open-data/12b48eaa-9374-40c7-b6ea-40dba64b3071/*
    s3://idc-open-data/a7cb5259-fd50-47f7-85b6-de1d9ee153dc/*
    s3://idc-open-data/f09e604a-ab7d-495c-b8a3-b9639d07f1a9/*
    s3://idc-open-data/0d2b65b1-bf37-423b-81b3-ef5459b82edc/*
    s3://idc-open-data/7eaa209a-f752-43c9-abae-8a61fdebff1d/*
    s3://idc-open-data/2b0328c7-4119-4033-922b-06ea1164eea4/*
    s3://idc-open-data/fe36c3ce-a3b1-42a5-bfa3-7b3c42a30d3e/*
    s3://idc-open-data/edecf8ab-96d8-41f3-819e-bea5b1d28090/*
    s3://idc-open-data/3cf748d7-1639-4394-97d8-37a474fe6438/*
    s3://idc-open-data/7a1b1541-b70c-42d3-9e1f-ae1b2ee7b193/*
    s3://idc-open-data/5c66c66e-7c22-47a8-9dea-740a467ae6b0/*
    s3://idc-open-data/5bc5901f-ccb4-431a-aace-e9c29c443dc4/*
    s3://idc-open-data/42fb8d58-4148-491f-9eb5-5a20a7e73c89/*
    s3://idc-open-data/abe12780-5c0a-4b78-8a72-e14af72ec9db/*
    s3://idc-open-data/c0978fda-f85b-4084-8c5d-148a1dd52a3d/*
    s3://idc-open-data/6d06bef7-0a96-4e42-83a4-30b91ec3ed83/*
    s3://idc-open-data/033a1f1e-df54-4a4f-9c9a-086cc1673492/*
    s3://idc-open-data/72452198-809b-481c-947a-d477fb2a7a7d/*
    s3://idc-open-data/f0645d9b-29d1-4272-b7c9-20b46e171051/*
    s3://idc-open-data/adf886cd-b308-4988-b3ff-6e4beda83634/*
    s3://idc-open-data/5ad0e254-25a5-4fa9-85bd-9cbee016877f/*
    s3://idc-open-data/fd505193-19d4-4ee8-845e-7da39ae02cf0/*
    s3://idc-open-data/46fd4afa-25df-42c3-b4e8-b5faf1b7ce0f/*
    s3://idc-open-data/4f5e84a6-1130-46de-8773-4468f9329db8/*
    s3://idc-open-data/9669e11c-5a09-4ed7-a852-eb637fa442d8/*
    s3://idc-open-data/341cbb42-6a81-4831-a6aa-7c253026ccc2/*
    s3://idc-open-data/e92d183c-9804-4c88-b439-7212024ad4e1/*
    s3://idc-open-data/b3fd49e1-48fd-45f7-a1f0-e8a7e4a5d589/*
    s3://idc-open-data/0f1eeeed-b200-43bd-9e2a-13254b188bfd/*
    s3://idc-open-data/f30ee036-5cf2-4b61-b91d-0e8f1da8f4d1/*
    s3://idc-open-data/968364f4-b60c-4b85-8f7f-5ca429fc2287/*
    s3://idc-open-data/e4d5cae5-dc21-43d7-ac78-ff728c378c36/*
    s3://idc-open-data/1d811e3c-a990-451b-979f-be7831db0588/*
    s3://idc-open-data/da048a20-a0bf-4d06-9866-101b7331c64b/*
    s3://idc-open-data/bb6ec8a6-ac53-4c70-91a4-67285dc3840a/*
    s3://idc-open-data/e2cf57fd-0e5c-4973-b99b-447382ef5885/*
    s3://idc-open-data/614bede3-086a-477d-996b-d3afb4bf7567/*
    s3://idc-open-data/7ca73e45-236f-4664-9d57-2f8f066e3dbe/*
    s3://idc-open-data/694c7fb4-d1cb-43dd-a120-afc54917edf1/*
    s3://idc-open-data/24fa3b5e-360d-4ab1-b181-41526f5fd612/*
    s3://idc-open-data/1f69f782-225c-4c07-b6aa-de53aaeb2453/*
    s3://idc-open-data/ad906339-95a1-4bd9-ba85-f1519bc78a00/*
    s3://idc-open-data/7ef23fb8-6a96-46f5-b258-f407af7c6a02/*
    s3://idc-open-data/637da9bf-fb97-4c2b-9494-f8ad4a2fa5be/*
    s3://idc-open-data/5061aacb-d202-4d95-b80b-7cf07e22d7d0/*
    s3://idc-open-data/42cc2fc9-4bf8-4092-8d5e-317812c0881d/*
    s3://idc-open-data/56a9818a-3183-4c3b-a12f-acbcedb71215/*
    s3://idc-open-data/0ac34ee8-2f21-43db-a6e1-5d598f5c5d6d/*
    s3://idc-open-data/f4b43087-d99c-4327-861f-82b8bec4c9a1/*
    s3://idc-open-data/8b9d19a6-0989-4f35-9be1-f7a327da7cbf/*
    s3://idc-open-data/fcf9d5b1-eb4b-4618-ac52-5881ce774a92/*
    s3://idc-open-data/d2922857-ea36-4146-bf76-616292976388/*
    s3://idc-open-data/ff15f32f-bbce-44c5-934f-5473a6be62aa/*
    s3://idc-open-data/1cf78b25-4ad1-43a9-a69e-7bc270efb711/*
    s3://idc-open-data/49a5ef00-9e52-46f3-962b-2f7b21dcdb60/*
    s3://idc-open-data/d3cbc944-34eb-4134-a76e-bedd94f0f9e4/*
    s3://idc-open-data/22e3d2ae-16f6-4fb1-b407-e86003b25c7a/*
    s3://idc-open-data/ef847d2b-1e30-4343-a9fb-782cf273bc67/*
    s3://idc-open-data/04d7cc26-a81b-4d86-8808-7614a2809f8c/*
    s3://idc-open-data/9e9ad0a6-9fc8-48c9-b32c-d2c21516312b/*
    s3://idc-open-data/292a99f3-36de-43fa-8c41-e75bcad84c16/*
    s3://idc-open-data/28a7bee7-3cba-4813-a39d-a9f0091087a7/*
    s3://idc-open-data/c23326c1-62a5-444e-a00a-e4c60361e542/*
    s3://idc-open-data/fe20ce24-1aca-4a48-9e02-fdc63e863057/*
    s3://idc-open-data/010fdedb-f664-47ad-ba32-bf5d1eab008d/*
    s3://idc-open-data/387df940-89a3-492e-9933-b425dc4f2424/*
    s3://idc-open-data/9b3422f7-8296-4374-925b-750f921ca94c/*
    s3://idc-open-data/ba00590a-e436-4572-9c03-c81083cdc606/*
    s3://idc-open-data/5848c8fb-6adf-4d6a-8fdd-c16e9f71fd51/*
    s3://idc-open-data/6ae33b8a-b151-4304-b7fd-aff052fafd9b/*
    s3://idc-open-data/bbf72d6b-7459-4477-9cb2-02c1a2a0ab27/*
    s3://idc-open-data/4d7ea070-896e-4aad-bfd5-7e93e14c2e03/*
    s3://idc-open-data/5ff520bf-16ef-41a8-b4f6-6e5ff884bfd3/*
    s3://idc-open-data/34826c0e-f800-4ff3-b5dc-5bd3986b4c68/*
    s3://idc-open-data/da4fcde2-946c-4862-b4e1-865cf6a62d3c/*
    s3://idc-open-data/01d62a19-0ee6-4561-980b-51c5137429f7/*
    s3://idc-open-data/9a386712-7478-4016-aacf-740255dd1e0f/*
    s3://idc-open-data/43af6ae6-08f5-44b0-b3a3-6a1c8ca11d32/*
    s3://idc-open-data/0dd03e5a-5a32-443d-a362-ad23f518c077/*
    s3://idc-open-data/bb76e91d-35ad-4d22-bb58-9c0eff436c63/*
    s3://idc-open-data/cf5d81b5-b1e0-49f2-869c-f9b27b12c553/*
    s3://idc-open-data/f1138b6e-7f9d-4748-af62-f4f2ea695594/*
    s3://idc-open-data/4e4882e1-c287-43d3-99b6-22aaa93a3064/*
    s3://idc-open-data/1c5c8957-773b-4047-a4fe-0c45acbe524b/*
    s3://idc-open-data/a39be5a3-fc37-48bb-972f-031ddecb3f26/*
    s3://idc-open-data/da179690-bf5a-4a3b-b857-bf10b95d24fe/*
    s3://idc-open-data/bc67a068-b9f4-472c-9070-de3c6a4332f6/*
    s3://idc-open-data/e99701cc-fb21-4d1c-8f3f-30a9f3f39d5e/*
    s3://idc-open-data/94bebbf6-0e00-4f4c-ab9c-a04dc038cc72/*
    s3://idc-open-data/953f5043-54e8-457b-9e10-62b009d683de/*
    s3://idc-open-data/9c143734-0fe2-4e7e-b879-e331626a4013/*
    s3://idc-open-data/47f273e7-c2bb-4025-9ba7-c8d684166710/*
    s3://idc-open-data/4c9301b6-938d-4fd6-89cb-c765d50613ad/*
    s3://idc-open-data/0f38f3c8-c719-4491-b77d-ea533b9dc5e2/*
    s3://idc-open-data/89f932be-4858-4961-bae8-9c8aa6b7eb68/*
    s3://idc-open-data/28a2f6cd-d80a-419a-9760-c612e0a2c88b/*
    s3://idc-open-data/8964f602-a74a-4b74-975c-cffb117944a8/*
    s3://idc-open-data/fd2c08c3-d624-4fc4-bb8e-0aa06dccffdf/*
    s3://idc-open-data/27bf8b35-cc41-42da-b543-7074ccde3599/*
    s3://idc-open-data/d39bf767-5894-4b76-b146-eece3defa483/*
    s3://idc-open-data/2f59e2cc-fe6c-4f56-aa2e-c4e15041f710/*
    s3://idc-open-data/61c4afb0-4ed2-424c-b587-2bf6a7cf30a4/*
    s3://idc-open-data/689088e8-ef05-42df-a3af-babe45445486/*
    s3://idc-open-data/50ac117a-6308-464c-8afc-f28e0b38395d/*
    s3://idc-open-data/9db78384-d8fd-4d07-8b92-ceaee780664f/*
    s3://idc-open-data/07304ea9-0e71-413e-9c5b-5e2399f3c812/*
    s3://idc-open-data/49d1b156-76ec-4f21-926c-59a84f749112/*
    s3://idc-open-data/83c66e2a-675f-4e51-a20a-18b7154aa1c5/*
    s3://idc-open-data/fc0782cd-b743-40bc-a227-5cb823c7a84a/*
    s3://idc-open-data/7be6336a-648e-44c8-b07e-ba0f82cb0688/*
    s3://idc-open-data/dfbcd21d-bce3-4f16-b893-c4fa12d2ff36/*
    s3://idc-open-data/78bcee3d-7d1b-4dd8-ac56-dd324e910489/*
    s3://idc-open-data/32715ad5-1b20-4b8e-b879-944a9702a58b/*
    s3://idc-open-data/ecc2b793-cb0e-4132-bc36-301e2fda4cf2/*
    s3://idc-open-data/b78104c9-2cfa-443d-a27a-c364fce030ef/*
    s3://idc-open-data/cc6900b1-f5d5-4adb-b09c-bac88c427acf/*
    s3://idc-open-data/4a3fb4ae-c947-4156-ac1f-09fe08bdef71/*
    s3://idc-open-data/b137f45f-3750-42d9-87e5-1241b00d3e07/*
    s3://idc-open-data/83a6c99a-36e2-4aeb-8a6b-0e50c4cd6922/*
    s3://idc-open-data/4bf5672e-9a9b-40eb-b701-30b09190c581/*
    s3://idc-open-data/c80fb367-17d1-4d0f-a490-4725a37a8850/*
    s3://idc-open-data/e526f5a9-974c-4ae8-af2e-0452da3e0d58/*
    s3://idc-open-data/dc747ca7-e1b6-4ca7-bc20-4e0ede599fdc/*
    s3://idc-open-data/3e9f021c-0cbc-42c8-9b1a-dce8dbb307df/*
    s3://idc-open-data/602cec24-bf79-4286-b9c8-79764af5c913/*
    s3://idc-open-data/df2a0577-2b65-4256-8ca0-761276344ea1/*
    s3://idc-open-data/244cf72c-ad7b-4588-8305-45b95b3d98d5/*
    s3://idc-open-data/13a9b926-5800-4cd7-9958-4fe142e7e517/*
    s3://idc-open-data/69383fb6-aa56-4cfd-9bbe-c4723f07967f/*
    s3://idc-open-data/64eb7866-dda2-4282-9a34-3167305e7d6d/*
    s3://idc-open-data/17285eba-f552-4737-a5b2-5b2992f9b583/*
    s3://idc-open-data/dfa75c7b-f751-4811-a265-cf742a35e5b0/*
    s3://idc-open-data/e44a4210-a0fe-48be-a395-3ef0c37df13e/*
    s3://idc-open-data/e6ea0a4d-5eec-456a-bc81-b6cf5af5b701/*
    s3://idc-open-data/326bad7f-adde-452e-a433-fd71072cb22c/*
    s3://idc-open-data/f1e525be-ab1b-40d5-83b0-3aee8e26ad6e/*
    s3://idc-open-data/f5191f58-ba73-4d7f-bd24-8fa219ac99d7/*
    s3://idc-open-data/31cddaa0-ac3f-4652-9b46-852fdc9cc1a6/*
    s3://idc-open-data/73d3ffe2-869c-4aa7-9dfe-0691954b7422/*
    s3://idc-open-data/28746b23-9eda-4658-90b6-5b1002877aec/*
    s3://idc-open-data/c844fb17-27eb-4b63-a464-6fec304d9c9d/*
    s3://idc-open-data/881c5d08-7f16-4b1b-a1ff-6e893f40b204/*
    s3://idc-open-data/de5ec83d-dcd8-4bad-bfee-c69a885fe66d/*
    s3://idc-open-data/d3776fb3-e236-4ba2-9db8-d4b67f3fcf3a/*
    s3://idc-open-data/28abc0ac-e844-4c62-8583-70db33436758/*
    s3://idc-open-data/38183a99-f8f3-4711-8f3a-7a288146efc9/*
    s3://idc-open-data/59fab5e0-2639-43b2-87f6-70c100c3845b/*
    s3://idc-open-data/07515181-8035-4fc3-b74b-997beb1f8ec6/*
    s3://idc-open-data/a0ab6752-ef86-456f-8520-62b001933e8d/*
    s3://idc-open-data/58692052-51d2-4a6e-bca7-66917b6b045c/*
    s3://idc-open-data/741c27e3-f29c-4b40-a4fb-1dd6392b2859/*
    s3://idc-open-data/654d372e-d72f-4155-b2dd-18126b06b846/*
    s3://idc-open-data/0aae66c3-32c1-4c73-9842-c836f9fb56b2/*
    s3://idc-open-data/4518313c-27bb-4b95-a696-65083481a9ac/*
    s3://idc-open-data/976a5226-a65d-4fe8-baf2-81ba41e4ce2a/*
    s3://idc-open-data/069c447b-be8c-4769-95d2-16470a22e2ee/*
    s3://idc-open-data/8006eeb1-2dbb-4673-94d0-b2512a8dcd96/*
    s3://idc-open-data/bec14bc5-3176-4758-81ee-0d8fdf1c6301/*
    s3://idc-open-data/d68160a2-56da-4fdf-8748-da4584106d5d/*
    s3://idc-open-data/3aa2b817-3c4e-43f6-8f75-994f015e6346/*
    s3://idc-open-data/3f5b2efd-ec06-471c-8811-914e309ef3d0/*
    s3://idc-open-data/562b9bf3-78e2-48d3-836f-f86025b035f9/*
    s3://idc-open-data/dfc177d5-0bf6-42f7-b569-65ff73565473/*
    s3://idc-open-data/925ec397-f3ad-4235-bc3d-71547ff1b518/*
    s3://idc-open-data/b0e80531-5f7c-49fd-95f6-1f7f6cff4caf/*
    s3://idc-open-data/027433c9-0efc-4a1a-afd2-883ab943996c/*
    s3://idc-open-data/eefa15d9-37e9-4a33-a34a-98e82ee71442/*
    s3://idc-open-data/3a94620b-8529-44e5-bc40-d5a692f03b37/*
    s3://idc-open-data/5facd187-28d6-4dbc-bf21-6ace784d2be2/*
    s3://idc-open-data/6692e00c-d507-42ab-ae7f-7731c5ed5579/*
    s3://idc-open-data/0991ec63-46e9-438d-8d64-0e1383047c05/*
    s3://idc-open-data/02419a08-97eb-4bc3-9882-8e29c69e0cc3/*
    s3://idc-open-data/e1ed2c0f-e854-4e17-8b5f-cf03beaa634b/*
    s3://idc-open-data/0464c982-f14d-4f44-9db6-2ba2e262b25f/*
    s3://idc-open-data/5b62f000-7931-4aba-8a21-a64a76f26a2d/*
    s3://idc-open-data/affc6230-f7ca-480e-a55d-b25ba94683d1/*
    s3://idc-open-data/7e142b71-1ecf-412c-8a79-9ea59035fe52/*
    s3://idc-open-data/73a79e3c-fcf8-47b2-aab5-c74fbea5090d/*
    s3://idc-open-data/eae8ac8e-e30c-402e-8a19-11667e9e0eb6/*
    s3://idc-open-data/95918086-6965-4d75-89df-a2010fc10b2f/*
    s3://idc-open-data/e8ba875b-3889-4847-9c07-c02fa56cb25e/*
    s3://idc-open-data/cf109d55-03e9-4739-bd00-bdc75f7e5151/*
    s3://idc-open-data/539e0648-1dcf-45b7-8db8-348dedbe5348/*
    s3://idc-open-data/82c25562-453a-42fb-bd64-a4661b7feafd/*
    s3://idc-open-data/1617c164-4d33-40e4-bf8b-6fd5ce429cfd/*
    s3://idc-open-data/92a7df47-cfba-439a-a85a-b7d4d479af30/*
    s3://idc-open-data/1f65cfeb-5628-4079-9391-a299e5bf6169/*
    s3://idc-open-data/de686835-4b14-438b-b416-d3f79c66f0ff/*
    s3://idc-open-data/78157880-0b18-4227-8f5f-7014bd64df98/*
    s3://idc-open-data/6f3a1370-3f64-4385-951d-2ef5343a818c/*
    s3://idc-open-data/696be9cf-6420-471e-90e5-b284ec80333e/*
    s3://idc-open-data/75f5ce86-52ad-4e2a-ba18-67357c6e06d2/*
    s3://idc-open-data/2d12f159-1c9f-49ee-9b71-026edafc5b16/*
    s3://idc-open-data/47e8904c-5640-4bd9-b362-deebc24355ea/*
    s3://idc-open-data/e3031758-22dc-4095-89f5-93ac4b6718bd/*
    s3://idc-open-data/4dc2edc7-e1b4-43e6-a6d1-b6496ce0919f/*
    s3://idc-open-data/e81571d9-c8a4-4d42-9fb4-a1fdf983580b/*
    s3://idc-open-data/eb502aff-ea24-4d2b-a19c-4d39a8a95073/*
    s3://idc-open-data/c3431f5d-4316-4b7a-884d-f71ba029d858/*
    s3://idc-open-data/1e595db8-d2f4-4975-9998-42cab8d44ade/*
    s3://idc-open-data/779beaf4-6204-4c7d-a7cb-75936d067a6f/*
    s3://idc-open-data/680db90e-79e0-4138-b74f-cb2ab4cd25a8/*
    s3://idc-open-data/06228da3-4124-42fb-9dc2-c3970401f313/*
    s3://idc-open-data/cd24796f-8ecc-48da-a306-f7ebd3a872b8/*
    s3://idc-open-data/0122f8f0-eeaa-4780-bd4f-0f91a8f68d07/*
    s3://idc-open-data/fdfa52c0-9274-468a-8eab-b6236cd7a294/*
    s3://idc-open-data/51c5d718-3624-4568-b0ca-b2c38cb01703/*
    s3://idc-open-data/723ffe00-8e0e-4ff3-be78-67b275752544/*
    s3://idc-open-data/df89bccc-ae3a-4407-ac21-855ba37b3872/*
    s3://idc-open-data/7ca01059-bd46-410b-87e9-ee98219a684c/*
    s3://idc-open-data/3ef2c082-d5f5-4ef0-b720-40026cef332c/*
    s3://idc-open-data/b3174034-8f6e-4523-9f11-a778de97debd/*
    s3://idc-open-data/e2453289-507b-4569-b765-106c53bd8d3e/*
    s3://idc-open-data/84c6b223-05a9-4ccf-8bf2-ca35a35bf5eb/*
    s3://idc-open-data/858242d9-16c7-40ab-8514-4e23c215cf2d/*
    s3://idc-open-data/48e59c9a-1a4e-4a78-af38-845256882053/*
    s3://idc-open-data/394f6537-a33a-46ee-a653-61a4c0b01911/*
    s3://idc-open-data/4f9c94d8-1dda-446a-addb-cbf144de55c6/*
    s3://idc-open-data/797dd5b2-e16f-48a3-8d48-72f55ed3031f/*
    s3://idc-open-data/0ec087a2-27b1-4dfb-9732-c61d13ca8de9/*
    s3://idc-open-data/978f8c40-08cf-4edd-8456-00193c23b3c6/*
    s3://idc-open-data/11f5e54a-a91a-48a1-9db2-b1a22ae00619/*
    s3://idc-open-data/39a4e8f9-6da1-49c8-9463-8fff29b2f9cb/*
    s3://idc-open-data/9b4ea38c-3913-4af7-a16c-6065f9a72392/*
    s3://idc-open-data/5c76f631-3df7-4faf-afb3-3aea4b07c238/*
    s3://idc-open-data/2f96aecb-fed7-4d62-ae32-15d0dcec2ce6/*
    s3://idc-open-data/85fa523e-ad31-4035-9c42-2cbc3d9bdd50/*
    s3://idc-open-data/f0b65884-dd0b-46eb-b6a1-ae0e29b08d85/*
    s3://idc-open-data/8848ba58-e9e7-461e-9c5a-96332e8ff02c/*
    s3://idc-open-data/6b406438-a89e-415d-b0da-f7a52398e866/*
    s3://idc-open-data/564ad872-1a1f-4ee5-b7b4-5a85adeb2ffb/*
    s3://idc-open-data/01a7328f-9c5d-4fd8-a35d-df21a06854ff/*
    s3://idc-open-data/b20b4773-2053-4872-81cc-97fa24ac1c56/*
    s3://idc-open-data/42e419a4-a7ee-455a-8c7f-9ac8527e85d2/*
    s3://idc-open-data/dab63377-bc3c-4ea9-bad4-109ce529c68e/*
    s3://idc-open-data/b06e2e27-97b2-446a-b027-59d8c751acdb/*
    s3://idc-open-data/5b50ff55-ecbb-4073-a8c3-a74c7d0a1b81/*
    s3://idc-open-data/a2efd191-4d1d-44b1-8b6e-edbf17e5531b/*
    s3://idc-open-data/e8c382a6-905a-4e71-b11d-92fb2cd44fa4/*
    s3://idc-open-data/464c3ca8-f5fe-4530-8777-b97f0c2a259d/*
    s3://idc-open-data/38b26336-4b77-49f2-bfa5-65584202a880/*
    s3://idc-open-data/02e66ecd-cb5f-4461-af1d-6b1521617a82/*
    s3://idc-open-data/4c932219-73d9-4978-9b15-46e20c1b9d9a/*
    s3://idc-open-data/7d340558-1c3d-4287-a69c-f3d9bbea1ed1/*
    s3://idc-open-data/74cdfeb4-0bf4-46a0-b5ae-5702a469f1e3/*
    s3://idc-open-data/0463ad92-6a4e-4f2d-a42f-99c49a4a3059/*
    s3://idc-open-data/937854fd-13db-40cf-91e0-8cdf362f33b7/*
    s3://idc-open-data/56242154-013f-4cac-9e3f-1c2d4e33b8d5/*
    s3://idc-open-data/5ae6c13b-226a-4820-b615-4f938364299c/*
    s3://idc-open-data/f3eeadea-eb67-4174-a0c4-39abb581faf8/*
    s3://idc-open-data/1b54fae1-18b5-42b1-a0df-f9eaebefecd0/*
    s3://idc-open-data/5d588c2e-4566-4293-961f-398623260082/*
    s3://idc-open-data/c8cc79a3-ea63-4663-82cd-42746dad95b8/*
    s3://idc-open-data/6cffcad1-6360-4f45-82f0-cf691063a91b/*
    s3://idc-open-data/dc5954c1-f0ba-4487-ad88-4909bc77c13a/*
    s3://idc-open-data/1fa4c1da-7ac6-4366-bfd2-127f6c5d3dfe/*
    s3://idc-open-data/1308a930-c0ee-409f-affb-56d60e670372/*
    s3://idc-open-data/2327ed8b-b6a6-42f5-9ee4-c9e02a81fb77/*
    s3://idc-open-data/14b125f4-5b4b-47cc-9bb0-2f2cf3a80e3b/*
    s3://idc-open-data/30df3fdf-d64e-4cf2-8c15-f5799aa404b3/*
    s3://idc-open-data/617d0c45-4097-4cae-a195-9133e7b56f15/*
    s3://idc-open-data/fc3972ce-b35b-475e-818f-5e41c97d82c7/*
    s3://idc-open-data/bd9e198c-937d-47a6-b95d-a6dd004a9396/*
    s3://idc-open-data/264c8cb6-1934-43c5-97db-5dac05f5bf5a/*
    s3://idc-open-data/1900f496-c348-4e20-80ab-04d72216d468/*
    s3://idc-open-data/ab2ba2a8-1663-4bd7-8557-f25f795bfd8a/*
    s3://idc-open-data/837f4af9-2b0f-4e17-bd44-d96f7857836b/*
    s3://idc-open-data/7dc85660-6be7-4520-a946-87b357f49c58/*
    s3://idc-open-data/1b9862d5-5f0e-4e7a-aea6-44983d871278/*
    s3://idc-open-data/fceae220-f6e1-46da-87d8-b4c8a4099ebc/*
    s3://idc-open-data/225b72f5-570a-4360-88a1-55919474e802/*
    s3://idc-open-data/ab681029-e7ec-4b77-8274-9fa6046be499/*
    s3://idc-open-data/cd6ba2c1-4ab1-446f-a7ae-43a9974909bd/*
    s3://idc-open-data/10436bb7-7ff6-4b13-bcb1-a6a1bc20e3c5/*
    s3://idc-open-data/81758899-1d5b-4669-82be-9f37d602d2fc/*
    s3://idc-open-data/b8f84a61-80a2-4a28-ac0b-256e4ed18b73/*
    s3://idc-open-data/d16fc0f9-ccbb-4c2a-ab98-69be64a94c1f/*
    s3://idc-open-data/553ca43d-c5a1-492e-8d19-35a7d03abeb1/*
    s3://idc-open-data/f61e456e-7576-45c6-b4ae-cdcdb9dc2f34/*
    s3://idc-open-data/9cf6de8a-f4ef-43e2-9797-22c8f171fa0f/*
    s3://idc-open-data/4a18c676-9540-4b68-80f3-2a1a1b14ca4f/*
    s3://idc-open-data/d0b67a4f-d7e8-4890-8f7d-25d8521dc351/*
    s3://idc-open-data/a28f2163-5b36-4398-9e33-d2efdc4962c2/*
    s3://idc-open-data/3f61170e-5c65-46ce-9ef1-3ddd023a692c/*
    s3://idc-open-data/944a527d-0b7a-4f19-93f5-8632e48849fc/*
    s3://idc-open-data/419df10c-7ce5-4346-a52b-417f23c3554b/*
    s3://idc-open-data/3e8ac743-933d-446e-98df-567983be309a/*
    s3://idc-open-data/c4d63d00-2788-46f7-9d87-857b2ef3f122/*
    s3://idc-open-data/6b68ff17-4057-4f4f-b794-5636ee6707b9/*
    s3://idc-open-data/a492678f-8533-4189-9d56-12787474c932/*
    s3://idc-open-data/763fe058-7d25-4ba7-9b29-fd3d6c41dc4b/*
    s3://idc-open-data/a61e1927-bb5b-4fa0-b1ed-4f7de64f4ca4/*
    s3://idc-open-data/35f9e9de-fd3a-41b2-9016-448c396db3cb/*
    s3://idc-open-data/4255ec7c-759c-4ea1-80e0-2370bf614d81/*
    s3://idc-open-data/126d71b2-86bf-4465-a305-7c0eb7e6e1c8/*
    s3://idc-open-data/2ad3177c-d76d-4b54-9691-3109b950b30d/*
    s3://idc-open-data/d312c38b-9b0d-4b3a-868b-f2dc921e357c/*
    s3://idc-open-data/e0d576bf-a225-4c2a-8a31-22e220630995/*
    s3://idc-open-data/3d4140a0-331f-40fc-85b0-0479d7bcf412/*
    s3://idc-open-data/69e2e165-2f2e-413e-9ecd-ccb84db4141f/*
    s3://idc-open-data/86993c10-80ec-4f40-9e16-5f003f81082d/*
    s3://idc-open-data/068fe344-8009-4cf1-ad20-4c8c14fc1412/*
    s3://idc-open-data/257db373-5dd4-41b6-b4ac-c30e63aa0586/*
    s3://idc-open-data/0b6d3d2e-f889-4dbd-8037-fb207c568543/*
    s3://idc-open-data/31dd3f39-62e7-4e87-90f6-1b65457a64df/*
    s3://idc-open-data/e3997693-7423-44df-ad60-e871e5baaaa9/*
    s3://idc-open-data/1be28b5c-f725-4b14-942b-b531d54c59d7/*
    s3://idc-open-data/2c3748d5-efc4-4e5c-aa48-be6762c22203/*
    s3://idc-open-data/3c8de498-f032-43e3-bd2c-fde07ae63588/*
    s3://idc-open-data/218f4fbb-d546-429a-b2ef-77d773dfbe6f/*
    s3://idc-open-data/7df83386-0289-47b8-b910-b8552b067074/*
    s3://idc-open-data/7094952e-d6d0-43eb-8a21-52ea6bd75dc7/*
    s3://idc-open-data/ad009628-ae14-4a7a-9427-47dd6aa3fc42/*
    s3://idc-open-data/55cf808d-72dc-4216-8b3e-f993ea92e7ac/*
    s3://idc-open-data/248a2391-2767-4fc6-9e3f-bec972cde19c/*
    s3://idc-open-data/9f00328e-8cbe-400e-a241-0fd8b63c0a5c/*
    s3://idc-open-data/46dc5063-585a-4dcd-a4b8-eda917749681/*
    s3://idc-open-data/149ef879-e687-4fe5-bf27-379028bd706c/*
    s3://idc-open-data/cbb6c474-7502-44b3-9667-d0a9ad49f4a6/*
    s3://idc-open-data/88ddef4f-2d17-4b73-b2fa-f26f80e0a8bf/*
    s3://idc-open-data/4d841496-9d01-4a39-b7c1-6d8b3a5ead65/*
    s3://idc-open-data/ce7787d9-af9b-44fd-bc67-eb0b5637c8d4/*
    s3://idc-open-data/b2ef47f4-74b1-4d71-b9d2-e87793b19e1d/*
    s3://idc-open-data/76b4e24c-0a0b-4a7f-bf12-610b13b45182/*
    s3://idc-open-data/1ecd1adf-c18a-4fe6-8ca7-b10437c285bb/*
    s3://idc-open-data/f08bf525-9e93-4e72-bc01-5c4de21042b5/*
    s3://idc-open-data/f6c8f05b-e3ca-4f79-a7f3-cf99cc390ba4/*
    s3://idc-open-data/52250fd9-47bc-40da-ba17-f928b3af5f4c/*
    s3://idc-open-data/f7fcfe57-a3e1-4396-8cd1-afa6aba97024/*
    s3://idc-open-data/bc7c9144-8087-4b0a-8477-e9303379414e/*
    s3://idc-open-data/4c08e19c-7561-461a-986b-da7f089de1d8/*
    s3://idc-open-data/e4be94d5-cffa-4d8c-9ab1-757fd2ec9d42/*
    s3://idc-open-data/32af5a4d-8e68-4e8a-8d3c-887debad3e1e/*
    s3://idc-open-data/58ae132c-5ba7-45ed-af74-fa996c910f4f/*
    s3://idc-open-data/a675eb48-1f69-4bb6-99f8-0b2bfc6a0215/*
    s3://idc-open-data/0814e12e-e3eb-49d7-a74c-ee7850f2c0d4/*
    s3://idc-open-data/0fd83fce-235e-4341-baf0-515fb2fd3520/*
    s3://idc-open-data/77be07bc-55b1-4480-aba1-23f24885d4a9/*
    s3://idc-open-data/def92e79-fede-4f99-88c3-2e26a0f5f2bc/*
    s3://idc-open-data/184f9ffa-f486-4fdc-a778-cb5be160998a/*
    s3://idc-open-data/7105b7d1-4b48-4eb9-a1fb-4ed1297c8e7d/*
    s3://idc-open-data/e9ffc88f-db14-4823-809f-0813946cf544/*
    s3://idc-open-data/83b824e3-9274-43d5-9e94-2e58802cc6b2/*
    s3://idc-open-data/4e215bed-a0c8-4be3-bfe4-8010ca845c9e/*
    s3://idc-open-data/d13eb86f-2f4d-4e4d-8c26-458c60dce1db/*
    s3://idc-open-data/572964a0-1a58-41c5-8140-3662b53fc9dc/*
    s3://idc-open-data/bce33695-4826-415f-a0e7-c47519bba29a/*
    s3://idc-open-data/a8d3dba2-6d24-4fc2-99c0-38907b913291/*
    s3://idc-open-data/6f8d6b48-de07-4332-b66b-4ce9c05a3654/*
    s3://idc-open-data/ab9a77ed-cc6d-4192-ad4f-b49008cad532/*
    s3://idc-open-data/f6c6e66b-6e02-4796-9b9b-012cef99c6d4/*
    s3://idc-open-data/7bcd4ef6-72b8-4ec9-9ab8-be56782f1537/*
    s3://idc-open-data/1d232823-52db-4dfb-9f12-e8e99f81e404/*
    s3://idc-open-data/d9d17114-8b85-43e7-9b96-764c3a3f98ef/*
    s3://idc-open-data/976f9d21-2b0d-44db-a54c-bd26b85205a4/*
    s3://idc-open-data/43511bef-9bfd-4fc9-985b-c029e2adc509/*
    s3://idc-open-data/cbcd4f7b-ac80-447f-bff3-1e9b7d0501b5/*
    s3://idc-open-data/65455c1c-ee44-401a-8b5f-40fbcc47c2b8/*
    s3://idc-open-data/4330fda1-6380-491d-93a0-9f72b835b3d7/*
    s3://idc-open-data/ff2296dd-1f01-41a9-a734-b298e6eb7f46/*
    s3://idc-open-data/11550536-5531-4cf6-b14c-5848981597d1/*
    s3://idc-open-data/5f824530-7c1e-42d6-84e8-2af24bbd005f/*
    s3://idc-open-data/b1313c4a-d5e0-49b4-95f9-88aea56a88f3/*
    s3://idc-open-data/ea1cdd5d-0a44-4508-836c-0080f5e1b069/*
    s3://idc-open-data/5f8871d4-d620-4222-a922-a0807a271243/*
    s3://idc-open-data/edab63f0-bd8d-447a-9038-fff3c61cae8c/*
    s3://idc-open-data/34e6f208-f622-465b-b567-47c8d9400d4a/*
    s3://idc-open-data/d64bade5-7756-4545-aefa-2c9465a687da/*
    s3://idc-open-data/6c116ed9-f2ab-423c-9cd0-72f5e86e1cb3/*
    s3://idc-open-data/55048b7b-08ee-4e22-bd21-1831f5eebe8a/*
    s3://idc-open-data/953bcb1c-b050-46ca-a71a-2b29f5c1e956/*
    s3://idc-open-data/b25971b9-0c2c-49a8-b315-ad34070ec36a/*
    s3://idc-open-data/77fed9ec-9137-40f7-ab32-68306cc41bc3/*
    s3://idc-open-data/fbd86b6c-8e2c-4ed7-b4d1-9b03bf2ca240/*
    s3://idc-open-data/8524b66e-3ea1-4c35-bafb-df14d94eaa3c/*
    s3://idc-open-data/6162b65f-292f-4eba-baee-1ac6f27b8255/*
    s3://idc-open-data/6919e1f1-5f1b-486b-88e4-7a87ab13e724/*
    s3://idc-open-data/1c0e2327-a15f-4934-8d18-3e035a0b7b27/*
    s3://idc-open-data/bce30285-59d5-4018-9631-ee6f76c87f84/*
    s3://idc-open-data/75caf1fb-83fd-43ca-83ae-6643d5c36598/*
    s3://idc-open-data/a7e07884-50b5-4993-9a15-f9b8be668ee8/*
    s3://idc-open-data/cce5be1f-c5a9-451c-b89f-4c51b0187953/*
    s3://idc-open-data/702d3695-5416-4831-8e5a-89afb0e94639/*
    s3://idc-open-data/5ba3dcfd-2b5f-41be-a8d3-65e4cecaaaaf/*
    s3://idc-open-data/0014399f-8a31-4ffc-a29b-b9271e3db9ca/*
    s3://idc-open-data/ccb1ceac-cceb-4319-a8db-a2f103faffe0/*
    s3://idc-open-data/31ce0f07-be4b-4573-acac-c5ade7dca93b/*
    s3://idc-open-data/47bf719e-5df5-4cc5-8990-2e784491bcb7/*
    s3://idc-open-data/67438aac-2f4c-4741-b471-290f43a4abe5/*
    s3://idc-open-data/d2431838-4235-43a7-873b-0e835ba2c8c3/*
    s3://idc-open-data/f2eaee66-9bfd-4dd9-9457-d7ea3d66d719/*
    s3://idc-open-data/2d184552-e303-443b-9f57-addc38cebdf3/*
    s3://idc-open-data/86407cfa-86c3-46a5-ae30-72abbc8fc988/*
    s3://idc-open-data/78e76d6f-b6bc-4fc1-b88a-25c973660b31/*
    s3://idc-open-data/811014ab-2960-4d66-a42e-2b2e3f46e20b/*
    s3://idc-open-data/757e96ff-accf-4dbb-acef-dda213dd0df3/*
    s3://idc-open-data/6b494c0e-a635-4a20-9220-7b250cc9cbf5/*
    s3://idc-open-data/3e79e1a3-ab47-4f0c-b508-4085a8759826/*
    s3://idc-open-data/3b77975d-542d-4f9a-a4fd-a5969a750f96/*
    s3://idc-open-data/a49760f6-bcf4-4494-9884-70b058fd897e/*
    s3://idc-open-data/53bdcd45-e048-46c2-a868-2697437c138e/*
    s3://idc-open-data/fa48a7b9-9ba4-40c5-9972-cfed4dc8750a/*
    s3://idc-open-data/2f07ed59-354b-4f11-b8d5-38ca14527a30/*
    s3://idc-open-data/96304579-4634-42be-a5b1-e7f50b40ce97/*
    s3://idc-open-data/fdcce5cd-0940-47aa-b3a3-e62bb2814270/*
    s3://idc-open-data/8590814e-4056-403a-9ab7-e252efc5f4e3/*
    s3://idc-open-data/7ea27a4d-2ee3-4feb-88ce-1d255dbab015/*
    s3://idc-open-data/f42ad23a-6df5-4c4d-8fe5-0cc5253ee3b1/*
    s3://idc-open-data/27c6ab27-4456-4def-97e6-abc2a35bdd24/*
    s3://idc-open-data/727daeab-cd5e-4dd7-8c21-5ca8f00e5642/*
    s3://idc-open-data/9d2c60ab-b016-4038-8555-273e914b1aa2/*
    s3://idc-open-data/d0d867e5-f9eb-48e9-bbe3-8906f0859ed7/*
    s3://idc-open-data/3ec6b30c-fe3e-478a-8fd5-be55d7927bc1/*
    s3://idc-open-data/ae541b70-9b69-44b4-a68a-0a710d2e4b8f/*
    s3://idc-open-data/61c82597-b85d-4640-ac7f-544d0f62517a/*
    s3://idc-open-data/ee381cec-9697-410d-9066-4298d19d71c6/*
    s3://idc-open-data/0b1ecd15-8b58-4ca1-85ac-c3d38ee8abb0/*
    s3://idc-open-data/cb8729ad-7e12-4c1b-acd3-999ff86daf73/*
    s3://idc-open-data/bdc079aa-c8f2-4576-8da5-bb5423095400/*
    s3://idc-open-data/f8d5d8d1-c1f9-4ade-9606-3375b72098cb/*
    s3://idc-open-data/55b8d486-b531-47df-b2d3-ac8124b246ce/*
    s3://idc-open-data/178b4b1a-948b-4a59-9449-858f99bb5265/*
)

# Use the SLURM_ARRAY_TASK_ID to determine which URL to process
S3_URL=${S3_URLS[$SLURM_ARRAY_TASK_ID]}

echo "Processing $S3_URL..."

# Run the Singularity container with the S3 URL and base directory
# The Python script inside the container will handle the creation of subdirectories, downloading, and file processing
singularity exec $SINGULARITY_CONTAINER python /flashscratch/thiesa/Containers/process_dicom.py "$S3_URL" $BASE_DIR

echo "Processing complete for $S3_URL."
